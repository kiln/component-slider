(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?module.exports=e(require("d3-selection"),require("d3-axis"),require("../node_modules/d3-scale/src/linear.js")):typeof define==="function"&&define.amd?define(["d3-selection","d3-axis","../node_modules/d3-scale/src/linear.js"],e):t.Slider=e(t.d3,t.d3,t.d3.scaleLinear)})(this,function(t,e,i){"use strict";i="default"in i?i["default"]:i;var n="1.2.1";function a(e){this.container=t.select(e);this._width=null;this._height=null;this._handleRadius=15;this._channelHeight=5;this._channelRadius=null;this._handleFill="black";this._channelFill="#eee";this._margin={top:null,left:null,right:null};this._domain=[0,1];this._value=null;this._snap=false;this._scale=null;this._axis=false;this._ticks=null;this._tickFormat=null;this._tickSize=null;this._label=null;this._labelSize=18;this._startLabel=null;this._startLabelBelow=false;this._endLabel=null;this._endLabelBelow=false;this._startEndLabelSize=16;this.handlers={change:[]}}function s(t){if(t.length>0&&t.charAt(0)=="_"){a.prototype[t.substr(1)]=function(e){if(typeof e=="undefined")return this[t];this[t]=e;return this}}}var r=new a;for(var l in r){s(l)}a.prototype.margin=function t(e){if(!e)return this._margin;for(l in e){if(l in this._margin)this._margin[l]=e[l];else throw"Kiln.slider.margin: unrecognised option "+l}return this};a.prototype.on=function t(e,i){if(!(e in this.handlers))throw"Kiln.slider.on: No such event: "+e;this.handlers[e].push(i);return this};a.prototype.fire=function t(e,i){if(!(e in this.handlers))throw"Kiln.slider.fire: No such event: "+e;var n=this.handlers[e];for(var a=0;a<n.length;a++){n[a].call(this,i)}return this};function h(t,e,i,n){if(typeof i==="undefined")i=0;if(typeof n==="undefined")n=t.length;if(n-i==0)return e;if(n-i==1)return t[i];if(n-i==2){var a=Math.abs(t[i]-e),s=Math.abs(t[i+1]-e);if(a<=s)return t[i];else return t[i+1]}var r=i+Math.floor((n-i)/2),l=t[r];pre=r-1,pre_v=t[pre];if(pre_v<=e&&e<=l){return Math.abs(pre_v-e)<=Math.abs(l-e)?pre_v:l}if(l<=e)return h(t,e,r,n);else return h(t,e,i,r)}function o(t,e){if(typeof t=="boolean"){return t?Math.round(e):e}return h(t,e)}a.prototype.draw=function n(){var a=this;var s=this._width,r=this._height;var l=this.container.node();if(!s){var h=l.getBoundingClientRect();if(!h||h.width==0)return this;s=h.width;r=h.height}var u=this._channelRadius==null?this._channelHeight/2:this._channelRadius,c=this._margin.left==null?Math.max(this._handleRadius,u):this._margin.left,d=this._margin.right==null?Math.max(this._handleRadius,u):this._margin.right,f=this._margin.top==null?Math.max(this._handleRadius,this._channelHeight/2):this._margin.top,_=s-c-d,v=_+2*u,m=this._labelSize*1.5;if(this._label!=null&&this._margin.top==null)f+=m;var p;if(l.namespaceURI=="http://www.w3.org/2000/svg"){p=this.container}else{p=this.container.selectAll("svg").data([{width:s,height:r}]);p.exit().remove();p=p.enter().append("svg").merge(p);p.attr("width",function(t){return t.width}).attr("height",function(t){return t.height})}var g=p.selectAll("g.slider-container").data([{left:c,top:f,id:this._id}]);g.exit().remove();g=g.enter().append("g").attr("class","slider-container").merge(g);g.attr("transform",function(t){return"translate("+t.left+","+t.top+")"}).attr("id",function(t){return t.id});this.scale=(this._scale?this._scale():i()).domain(this._domain).range([0,_]);if(this._value==null||this._value<this._domain[0])this._value=this._domain[0];else if(this._value>this._domain[1])this._value=this._domain[1];if(this._snap)this._value=o(this._snap,this._value);var b=[];if(this._axis){var x;if(typeof this._axis!="boolean"){x=this._axis(this.scale)}else{x=e.axisBottom().scale(this.scale).tickPadding(6)}if(this._ticks)x.ticks(this._ticks);if(this._tickFormat)x.tickFormat(this._tickFormat);if(this._tickSize)x.tickSize(this._tickSize);else x.tickSize(Math.max(5,this._handleRadius-this._channelHeight-2));b.push(x)}var w=g.selectAll(".slider-axis");var L=w.data(b).enter();L.append("g").attr("class","slider-axis").attr("transform","translate("+0+","+this._channelHeight/2+")").each(function(e){e(t.select(this))});L.select(".domain").attr("fill","none");L.selectAll(".tick line").attr("stroke","black");L.exit().remove();var y,z;y=g.selectAll(".slider-channel").data([{width:v,height:this._channelHeight,channel_r:u}]);y.exit().remove();y=y.enter().append("rect").attr("class","slider-channel").attr("fill",this._channelFill).attr("cursor","pointer").on("click",function(){var e=Math.max(0,Math.min(_,t.mouse(this)[0]));a._value=a.scale.invert(e);if(a._snap)a._value=o(a._snap,a._value);z.attr("cx",a.scale(a._value));a.fire("change",a._value)}).merge(y);y.attr("width",function(t){return t.width}).attr("height",function(t){return t.height}).attr("y",function(t){return-t.height/2}).attr("x",function(t){return-t.channel_r}).attr("rx",function(t){return t.channel_r});var k,M;function S(t){document.addEventListener("mouseup",E,false);document.addEventListener("mousemove",R,false);k=t.clientX;M=a.scale(a._value)}function E(){document.removeEventListener("mouseup",E,false);document.removeEventListener("mousemove",R,false)}function R(t){H(t.clientX-k)}function B(t){if(t.touches.length!=1)return;document.addEventListener("touchend",A,false);document.addEventListener("touchmove",F,false);k=t.touches[0].clientX;M=a.scale(a._value)}function A(){document.removeEventListener("touchend",A,false);document.removeEventListener("touchmove",F,false)}function F(t){if(t.touches.length!=1)return;H(t.touches[0].clientX-k)}function H(t){var e=M+t;var i=Math.max(0,Math.min(_,e));var n=a.scale.invert(i);if(a._snap)n=o(a._snap,n);z.attr("cx",a.scale(n));if(n!=a._value){a._value=n;a.fire("change",a._value)}}z=g.selectAll(".slider-handle").data([{v:this._value,x:this.scale(this._value)}]);z=z.enter().append("circle").attr("class","slider-handle").attr("cursor","col-resize").merge(z);z.attr("cx",function(t){return t.x}).attr("r",this._handleRadius).attr("fill",this._handleFill).on("mousedown",function(){t.event.preventDefault();S(t.event)}).on("touchstart",function(){t.event.preventDefault();B(t.event)});var X=[];if(this._label){X.push({label:this._label,x:_/2,y:-m,font_size:this._labelSize})}var j=g.selectAll(".slider-label").data(X);j.exit().remove();j=j.enter().append("text").attr("class","slider-label").attr("text-anchor","middle").attr("cursor","default").merge(j);j.text(function(t){return t.label}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("font-size",this._labelSize);var q=[];if(this._startLabel){q.push({label:this._startLabel,x:this._startLabelBelow?0:-(u+5+Math.max(0,this._handleRadius-u)),y:this._startLabelBelow?u+15:this._startEndLabelSize/1.75-u/2,anchor:this._startLabelBelow?"middle":"end",font_size:this._startEndLabelSize})}if(this._endLabel){q.push({label:this._endLabel,x:this._endLabelBelow?_:_+(u+Math.max(0,this._handleRadius-u)+5),y:this._startLabelBelow?u+15:this._startEndLabelSize/1.75-u/2,anchor:this._endLabelBelow?"middle":"start",font_size:this._startEndLabelSize})}var K=g.selectAll(".slider-end-labels").data(q);K.exit().remove();K=K.enter().append("text").attr("class","slider-end-labels").attr("pointer-events","none").merge(K);K.text(function(t){return t.label}).attr("font-size",function(t){return t.font_size}).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("text-anchor",function(t){return t.anchor});return this};a.prototype.update=a.prototype.draw;function u(t){return new a(t)}u.version=n;return u});